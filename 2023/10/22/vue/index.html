

  <!DOCTYPE html>
  <html lang="zh-CN">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="description" content= >
  <meta name="keywords" content=hexo,theme,MiHoYo >

  <head>
    <title>
      vue [ comin-lin&#39;s blog ]
    </title>
  <meta name="generator" content="Hexo 6.3.0"></head>

  <body>

    <link rel="stylesheet" href="/css/header.css">
<div class="header">
  <div class="logo">
    <span class="pull-left">
      <a id="site-name" href="/">
        comin-lin&#39;s blog
      </a>
    </span>
  </div>
  <ul class="nav-list">
    
      <li>
        <a href="/">
          首页
        </a>
      </li>
      
  </ul>
</div>

      <!--<link rel="stylesheet" href="/css/top-header.css">
<div id="top-bar" class="fixed">

  <a class="goto-top" href="#"></a>
  <ul class="bar-list bar-list-1">
    
      <li>
        <p>
          <a href="/">
            <text class="bar-text bar-p1">
              首页
            </text>
            <text class="bar-text bar-p2"></text>
          </a>
          <text class="bar-p3">/</text>
        </p>
      </li>
      
  </ul>
</div>-->

        <div id="content-outer">
          <div class="content-inner">
            <link rel="stylesheet" href="/css/post.css">
<div class="posts">
  <a href="/index.html"><i class="fa fa-home
replay-btn" aria-hidden="true"></i></a>
  <div class="post-title">
    <p>
      vue
    </p>
    <hr>
  </div>
  <div class="post-content">
    <h3 id="vue3引入element-plus、router"><a href="#vue3引入element-plus、router" class="headerlink" title="vue3引入element-plus、router"></a>vue3引入element-plus、router</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">main.js</span><br><span class="line"></span><br><span class="line">import &#123; createApp &#125; from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App.vue&#x27;</span><br><span class="line">import router from &#x27;./router&#x27;;</span><br><span class="line">import ElementPlus from &#x27;element-plus&#x27;;</span><br><span class="line">import &#x27;element-plus/theme-chalk/index.css&#x27;;</span><br><span class="line">const app = createApp(App);</span><br><span class="line">app.use(router);</span><br><span class="line">app.use(ElementPlus);</span><br><span class="line">app.mount(&#x27;#app&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="vue3编写路由配置-src-x2F-router-js"><a href="#vue3编写路由配置-src-x2F-router-js" class="headerlink" title="vue3编写路由配置 src&#x2F;router.js"></a>vue3编写路由配置 src&#x2F;router.js</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">router.js</span><br><span class="line"></span><br><span class="line">import &#123; createRouter, createWebHistory &#125; from &#x27;vue-router&#x27;;</span><br><span class="line">import MyHome from &#x27;./components/MyHome.vue&#x27;;</span><br><span class="line">import MyLogin from &#x27;./components/MyLogin.vue&#x27;;</span><br><span class="line">import http from &#x27;./api/ajax_config.js&#x27;</span><br><span class="line">import MyUser from &#x27;./components/MyUser.vue&#x27;</span><br><span class="line">const routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: &#x27;/&#x27;,</span><br><span class="line">    name: &#x27;MyHome&#x27;,</span><br><span class="line">    component: MyHome,</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: &#x27;user&#x27;,</span><br><span class="line">        component: MyUser,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &#x27;/login&#x27;,</span><br><span class="line">    name: &#x27;MyLogin&#x27;,</span><br><span class="line">    component: MyLogin</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">const router = createRouter(&#123;</span><br><span class="line">  history: createWebHistory(),</span><br><span class="line">  routes</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//路由守卫</span><br><span class="line">router.beforeEach((to, from, next) =&gt; &#123;</span><br><span class="line">  // 如果目标路由是 &#x27;/login&#x27;，直接进行路由跳转</span><br><span class="line">  if (to.path === &#x27;/login&#x27;) &#123;</span><br><span class="line">    next();</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  // 否则发送 Axios 请求 判断是否登录</span><br><span class="line">  http.get(&#x27;/user/loginStatus&#x27;)</span><br><span class="line">    .then(response =&gt; &#123;</span><br><span class="line">      // console.log(response.data.code);</span><br><span class="line">      if (response.data.code === 200) &#123;</span><br><span class="line">        // 已登录，继续访问目标路由</span><br><span class="line">        next();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 未登录，跳转到登录页</span><br><span class="line">        next(&#x27;/login&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(error =&gt; &#123;</span><br><span class="line">      console.error(error);</span><br><span class="line">      next(false); // 取消路由跳转</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">export default router;</span><br></pre></td></tr></table></figure>

<h3 id="vue3使用代理解决跨域请求问题"><a href="#vue3使用代理解决跨域请求问题" class="headerlink" title="vue3使用代理解决跨域请求问题"></a>vue3使用代理解决跨域请求问题</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">vue.config.js</span><br><span class="line"></span><br><span class="line">const &#123; defineConfig &#125; = require(&#x27;@vue/cli-service&#x27;)</span><br><span class="line">module.exports = defineConfig(&#123;</span><br><span class="line">  transpileDependencies: true,</span><br><span class="line">  lintOnSave: false, // 关闭eslint校验</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      &#x27;/api&#x27;: &#123;</span><br><span class="line">        target: &#x27;http://127.0.0.1:8081/&#x27;,// 后端接口</span><br><span class="line">        changeOrigin: true, // 是否跨域</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          &#x27;/api&#x27;: &#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="vue3封装axios-请求基础路径，请求拦截器添加token"><a href="#vue3封装axios-请求基础路径，请求拦截器添加token" class="headerlink" title="vue3封装axios(请求基础路径，请求拦截器添加token)"></a>vue3封装axios(请求基础路径，请求拦截器添加token)</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">ajax_config.js</span><br><span class="line"></span><br><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line"></span><br><span class="line">// 创建自定义的 Axios 实例 http</span><br><span class="line">const http = axios.create(&#123;</span><br><span class="line">  // 设置基本的请求配置，如 baseURL</span><br><span class="line">  baseURL: &#x27;/api&#x27;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 添加请求拦截器</span><br><span class="line">http.interceptors.request.use(</span><br><span class="line">  function(config) &#123;</span><br><span class="line">    // 在请求发送前设置请求头的 Token</span><br><span class="line">    const token = localStorage.getItem(&#x27;token&#x27;);</span><br><span class="line">    config.headers[&#x27;token&#x27;] = `$&#123;token&#125;`;</span><br><span class="line">    return config;</span><br><span class="line">  &#125;,</span><br><span class="line">  function(error) &#123;</span><br><span class="line">    return Promise.reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default http;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">其他组件引入</span><br><span class="line">import http from &#x27;./api/ajax_config.js&#x27;</span><br><span class="line">其他组件使用</span><br><span class="line">http.get(&#x27;/user/loginStatus&#x27;)</span><br><span class="line">    .then(response =&gt; &#123;</span><br><span class="line">      // console.log(response.data.code);</span><br><span class="line">      if (response.data.code === 200) &#123;</span><br><span class="line">        // 已登录，继续访问目标路由</span><br><span class="line">        next();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // 未登录，跳转到登录页</span><br><span class="line">        next(&#x27;/login&#x27;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(error =&gt; &#123;</span><br><span class="line">      console.error(error);</span><br><span class="line">      next(false); // 取消路由跳转</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="vue3组件写法"><a href="#vue3组件写法" class="headerlink" title="vue3组件写法"></a>vue3组件写法</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">vue3兼容大部分vue2语法</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;;</span><br><span class="line">import &#123; ElMessage &#125; from &#x27;element-plus&#x27;; //显示消息的组件</span><br><span class="line">//使用vue3语法编写用户管理组件</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    //控制 添加用户弹窗是否展示 的变量</span><br><span class="line">    const addUserDialogVisible = ref(false);</span><br><span class="line">    //展示 添加用户 弹窗</span><br><span class="line">    const showAddUserDialog = () =&gt; &#123;</span><br><span class="line">      addUserDialogVisible.value = true;</span><br><span class="line">    &#125;;</span><br><span class="line">    //添加用户表单</span><br><span class="line">    const addUserForm = ref(&#123;</span><br><span class="line">      username: &#x27;&#x27;,</span><br><span class="line">      password: &#x27;&#x27;,</span><br><span class="line">      roleId: &#x27;&#x27;</span><br><span class="line">    &#125;);</span><br><span class="line">    //重设 添加用户 弹窗表单</span><br><span class="line">    const resetAddUserForm = () =&gt;&#123;</span><br><span class="line">      addUserForm.value.username=&#x27;&#x27;;</span><br><span class="line">      addUserForm.value.password=&#x27;&#x27;;</span><br><span class="line">      addUserForm.value.roleId=&#x27;&#x27;;</span><br><span class="line">    &#125;;</span><br><span class="line">    //添加用户</span><br><span class="line">    const addUser = () =&gt;&#123;</span><br><span class="line">      addUserDialogVisible.value = false;</span><br><span class="line">      ElMessage.success(&#x27;添加成功！&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line">    //添加用户表单规则 使用this.$refs.form.validate((valid) =&gt; &#123; 时进行表单验证</span><br><span class="line">    const addUserFormRules = ref(&#123;</span><br><span class="line">      username: [</span><br><span class="line">        &#123; required: true, message: &#x27;请输入用户名&#x27;, trigger: &#x27;blur&#x27; &#125;</span><br><span class="line">      ],</span><br><span class="line">      password: [</span><br><span class="line">        &#123; required: true, message: &#x27;请输入密码&#x27;, trigger: &#x27;blur&#x27; &#125;</span><br><span class="line">      ],</span><br><span class="line">      roleId: [</span><br><span class="line">        &#123; required: true, message: &#x27;请选择角色&#x27;, trigger: &#x27;change&#x27; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line">    //用户数据</span><br><span class="line">    const userList=ref([</span><br><span class="line">      &#123; id: 1, username: &#x27;admin&#x27;, password: &#x27;123456&#x27;, roleId: 1 &#125;,</span><br><span class="line">      &#123; id: 2, username: &#x27;user1&#x27;, password: &#x27;abcdef&#x27;, roleId: 2 &#125;</span><br><span class="line">    ]);</span><br><span class="line">    //roleId转化为中文</span><br><span class="line">    const getRoleName = (roleId)=&gt;&#123;</span><br><span class="line">      if (roleId === 1) &#123;</span><br><span class="line">        return &#x27;超级管理员&#x27;;</span><br><span class="line">      &#125; else if (roleId === 2) &#123;</span><br><span class="line">        return &#x27;楼栋管理员&#x27;;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        return &#x27;null&#x27;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">      addUserDialogVisible,</span><br><span class="line">      showAddUserDialog,</span><br><span class="line">      addUserForm,</span><br><span class="line">      resetAddUserForm,</span><br><span class="line">      addUser,</span><br><span class="line">      addUserFormRules,</span><br><span class="line">      userList,</span><br><span class="line">      getRoleName</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
  </div>
  
</div>
          </div>
        </div>

        <link rel="stylesheet" href="/css/footer.css">
<div class="bottom-outer">
  <div class="framework-info">
    <span>Power by</span>
    <a class="a1" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
    <span class="footer-separator">|</span>
    <span>Theme by</span>
    <a class="a2" target="_blank" rel="noopener" href="https://github.com/redhat123456/hexo-theme-MiHoYo">MiHoYo</a>
  </div>
</div>

          
            <!-- scripts list from theme config.yml -->
            
              <script src="/js/MiHoYo.js"></script>
              
                

  </body>

  </html>